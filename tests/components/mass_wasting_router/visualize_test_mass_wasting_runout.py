import pytest

import matplotlib.pyplot as plt
import numpy as np
import os

from landlab import RasterModelGrid
from landlab.components import LandslideProbability
from landlab.components import SinkFillerBarnes, FlowAccumulator, FlowDirectorMFD
from landlab import imshow_grid, imshow_grid_at_node
from landlab.grid.network import NetworkModelGrid
from landlab.plot import graph


from landlab.components.mass_wasting_router import MassWastingRunout
os.chdir('C:/Users/keckj/Documents/GitHub/code/landlab/LandlabTools')
import LandlabTools as LLT

# @pytest.fixture
# def example_mg
##esri ascii version of the test landscape
z = np.array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,128.9351,125.1288,121.8951,121.5981,122.4279,125.8437,129.7477,129.1295,126.3637,126.2999,124.7179,124.6351,125.4752,128.8615,133.1735,137.5371,137.2143,132.6741,128.3733,125.1302,125.0378,124.6693,127.8634,131.9728,133.4289,130.0452,126.8978,126.5699,126.5475,129.8346,132.6919,130.9015,130.7604,132.5556,130.047,126.8566,125.8205,125.8549,126.3244,125.7389,124.8807,125.8977,127.7762,129.8573,131.8035,135.3904,138.5684,140.2276,143.8991,148.8203,154.0504,155.1635,158.6612,0,
0,124.1115,117.3569,112.5745,112.7323,113.1907,118.3398,125.2376,123.1016,117.2754,118.3131,115.9254,115.9418,116.3323,120.6846,125.9639,133.3221,132.9193,125.5336,120.1675,115.8964,116.7199,115.3059,119.9545,126.9288,128.5662,122.3407,117.7149,118.0632,117.2544,123.5031,126.6386,122.0492,121.33,126.0262,123.8691,118.1511,117.2885,117.5388,118.4573,117.6056,116.1146,117.4141,119.5219,121.7154,123.2019,129.12,130.8789,131.741,136.3899,142.5842,148.0284,144.5167,150.9963,0,
0,119.4448,111.2493,104.4784,104.1021,105.1673,113.8313,120.1529,116.3872,109.116,112.7253,107.1076,107.4794,108.5305,113.2055,120.8421,129.6642,128.8674,120.2937,112.9126,107.9202,108.8795,107.1371,113.6013,121.7799,123.8748,116.3161,109.7678,109.97,108.9765,116.844,120.411,114.3952,112.8957,119.5559,119.2798,110.6851,108.947,109.3026,110.8254,109.65,107.3062,109.0697,111.4278,113.8441,115.6989,122.4296,123.4077,124.7023,131.3531,139.8885,141.4068,134.6488,142.8984,0,
0,115.8943,106.4896,98.24178,96.354,105.4148,112.7954,115.2983,108.6219,101.9738,106.411,100.4186,100.0175,104.6543,111.4508,119.5162,128.2023,125.9352,116.101,107.9731,101.8525,102.1046,100.7686,108.2751,117.0849,120.132,111.8811,103.6323,102.9168,102.0197,110.656,115.0891,108.1664,105.8634,113.6706,115.7118,109.9199,101.5335,101.9815,104.27,104.8381,99.3576,101.7994,104.3761,106.9925,110.0851,113.7655,118.0132,125.5769,134.5812,139.5955,135.7829,126.8289,135.7439,0,
0,114.8668,106.3838,98.05022,91.23875,99.58488,109.1029,110.5377,103.1437,95.70601,98.05376,94.73123,103.0032,111.5767,118.1126,124.8747,129.9333,126.2809,117.3845,109.3117,102.2998,95.8511,95.38748,103.3839,112.2678,117.8127,114.3523,105.2089,96.43236,95.88755,103.4982,110.3589,108.0425,99.68148,107.2458,108.9526,104.6359,96.44069,95.25704,100.3777,95.75152,104.7449,110.3732,113.8071,114.962,115.1637,120.8595,125.4943,131.8172,136.5081,135.4339,128.5986,120.2029,129.5686,0,
0,112.9147,104.4042,95.55563,87.44959,98.32367,105.8304,105.1577,98.12643,90.33837,89.91172,95.92243,102.5148,109.9165,118.1181,126.4975,129.1016,125.2978,117.4624,109.514,102.4579,99.12312,90.6254,97.59071,106.0655,114.9375,114.4272,105.855,97.40778,90.40145,98.25763,104.3545,104.4106,94.97911,97.78239,99.72933,101.0493,96.68225,89.90734,92.04761,95.51298,102.9107,110.769,118.6741,122.8456,122.6274,127.2061,133.3001,136.1611,133.8889,128.7355,121.7851,114.4603,124.2935,0,
0,109.9882,102.9704,94.73641,83.88973,93.42295,100.2425,97.99037,91.47797,85.62838,90.67066,96.29389,102.6159,109.8515,118.365,125.7818,123.8626,118.5503,117.1576,109.3724,100.9215,92.97973,87.53836,98.16554,106.5974,113.1732,113.1981,104.7731,95.22415,86.84254,89.94044,97.19196,100.4438,97.73979,88.4597,90.6386,93.84084,87.18833,95.94656,101.9992,103.492,101.3573,108.7108,116.8129,125.1402,130.5432,134.9014,137.5803,134.5995,128.3782,119.6842,112.8663,109.5331,119.8149,0,
0,106.549,96.77232,87.88251,80.48171,90.54738,91.44048,89.41762,81.94334,91.46429,98.23102,103.5816,110.5468,116.016,121.4959,123.0661,117.5405,109.9049,111.9422,109.7299,101.5131,92.75442,84.64471,92.66022,101.5262,107.7242,110.5449,107.9041,101.3087,93.30511,81.98925,86.27908,93.4366,94.44565,89.59692,82.04014,83.97701,93.79366,101.2091,108.0485,111.7285,109.7837,107.8748,114.5125,122.0379,130.1953,137.2893,135.6507,129.7775,120.7693,112.8331,105.2622,105.1729,116.3318,0,
0,105.6313,96.16319,86.44691,77.26214,84.16657,84.70834,77.7744,89.22999,97.77148,105.2174,110.257,114.158,115.6396,119.153,119.5427,110.7135,102.0929,102.7026,104.6464,101.4603,92.00682,82.07776,92.64398,98.47195,98.11646,104.2343,105.3741,100.6728,94.9159,87.19646,76.87224,86.10766,87.37036,79.58559,90.34655,92.72472,90.06461,98.07598,106.5213,114.7682,117.9656,116.3439,116.0122,123.6686,132.7149,135.9325,130.7481,121.9897,115.0173,106.9122,98.9437,109.0699,117.0484,0,
0,105.9061,96.93599,87.94543,79.90051,72.80301,73.6189,84.57509,90.23891,98.96429,106.7947,107.9066,107.5609,106.2793,112.8096,116.9696,112.2295,102.5342,93.34732,95.23899,97.52961,91.58038,79.43398,86.73003,89.33991,89.20403,97.47256,99.12618,92.52868,86.5601,81.22681,73.54105,75.00831,76.70657,88.12901,95.95969,101.3616,99.12614,96.44067,104.1768,112.6728,121.0263,124.6307,123.8717,130.0785,134.8638,132.7743,123.518,115.5442,108.0278,102.5275,95.2905,104.0371,114.0995,0,
0,105.7574,96.40403,86.64027,77.37627,70.14926,77.78127,84.45602,91.82045,99.42913,102.4898,98.66202,96.9698,97.54639,105.4386,112.9119,111.7945,102.7893,93.79873,85.57423,88.59147,91.44946,86.12515,75.31546,82.24869,81.43324,91.65664,92.52304,84.8155,78.35646,71.79408,82.69966,85.86129,79.54678,90.30652,98.33382,105.008,107.7486,105.3354,103.5147,111.1452,119.7408,128.4178,132.0702,134.3531,133.6965,129.4454,118.6311,109.2909,101.9592,96.14684,92.16843,102.0705,111.9191,0,
0,106.5966,97.92196,89.23942,85.31339,78.34022,67.64371,75.85401,85.53207,95.45763,96.01871,89.06139,86.88247,92.45335,99.94861,109.5169,110.7251,102.9975,94.72851,86.70323,78.7317,84.31085,86.26148,81.80597,71.04598,76.9388,84.53621,84.75403,77.58213,69.70176,80.59797,86.64351,93.63324,90.9323,84.10916,92.45351,101.9051,110.7227,113.968,112.2756,112.0412,120.1467,129.5939,132.7219,129.7681,125.193,127.3118,122.0067,114.9992,108.6575,99.97827,89.39674,100.9266,109.683,0,
0,106.0024,97.01839,87.9277,84.37273,77.15489,65.93417,77.34818,86.08304,90.60854,89.1973,80.94874,80.44977,87.82076,98.04396,107.0555,106.2443,101.1374,96.29115,92.24422,84.06251,72.49689,78.59041,81.64674,77.50075,67.24378,78.30833,77.01548,67.80166,75.12415,81.09756,90.85313,99.47278,97.61256,87.45438,93.68076,101.3249,109.9127,118.0213,120.7779,120.0957,126.5259,131.199,128.6109,121.0444,115.0195,121.0342,118.515,109.2618,105.3206,95.52833,86.68092,95.84563,106.2566,0,
0,104.7978,94.98528,84.79609,75.24914,69.22238,64.40892,71.5507,79.01789,80.5701,79.93268,73.76913,82.33333,91.6882,101.312,104.7776,100.0248,91.83815,86.46327,89.36264,85.8389,75.76701,66.53401,76.93427,75.66283,64.94058,72.82223,66.0084,75.34728,80.93106,87.49153,95.31187,104.0282,102.8904,95.19342,92.30496,100.9622,110.2284,117.4003,123.6513,128.2326,130.942,128.972,123.2444,114.4081,107.0334,115.4056,115.6857,106.4599,97.23037,93.86219,84.27444,95.7258,104.6287,0,
0,105.5139,95.60635,86.5217,84.9155,78.15141,71.53838,62.63352,70.60336,70.79686,68.08739,75.11115,83.57674,93.25319,101.4542,100.2166,92.33333,84.18734,76.74906,79.76694,81.67964,74.20535,63.13161,70.97005,71.33401,63.10893,64.21399,74.50308,82.51544,90.08168,94.64716,101.0745,108.9136,109.3522,103.6638,97.79954,97.74316,103.9618,111.3136,120.2348,128.6158,128.8109,123.6812,115.4888,108.3145,100.6683,110.6338,113.9189,105.379,95.81687,87.28864,81.76559,90.85129,101.3622,0,
0,108.3075,101.6636,96.33884,91.66637,85.65811,78.21058,70.22574,60.53104,63.13183,74.82595,83.80676,90.86664,96.6928,97.77728,93.52695,86.41708,78.3263,69.33878,70.01678,73.97417,67.66257,60.5322,61.21466,62.07352,70.45768,74.3315,72.71736,81.65686,91.10736,100.6474,107.9223,114.0508,115.8039,110.2258,104.4478,104.2769,104.5851,111.7721,120.6628,128.388,124.795,115.6328,109.1994,101.9719,95.22205,106.1202,112.126,107.3265,97.22163,87.99676,79.67619,89.75547,99.83714,0,
0,108.2105,99.6186,94.07861,87.81526,82.01867,76.28542,69.12219,59.4408,68.9006,77.59671,85.07761,91.56057,93.31353,90.16689,84.00922,77.44729,77.86662,71.0447,61.77311,66.4925,59.74007,68.88411,70.63068,72.54804,66.05733,76.51275,82.44963,82.79677,90.30737,98.96923,107.8663,116.5416,120.6777,118.1144,112.5051,111.581,111.2015,117.4781,125.2373,128.3596,121.2272,110.2499,101.3022,96.89068,90.43194,100.0664,108.7356,106.1988,96.27965,88.56405,77.55833,89.29745,98.35466,0,
0,106.2626,96.39742,86.04986,77.83987,70.6665,65.56422,61.54975,58.55449,65.91801,70.33723,77.56274,86.72896,85.89942,78.89352,78.13229,69.30037,71.04406,64.51788,58.04074,58.6609,66.81667,74.51083,80.75836,81.81999,76.04034,70.62386,82.15836,90.22452,97.03722,103.3927,109.8421,115.4709,120.5653,123.3729,122.0959,120.0241,119.3312,125.0634,128.5933,126.1229,117.8504,110.9163,101.0217,91.2796,86.27003,95.90957,105.1647,103.4334,92.9855,82.80469,75.28728,84.48542,95.11073,0,
0,106.975,97.55446,87.87965,80.41991,80.93042,74.75958,71.26264,65.46254,57.48885,63.05704,72.00095,82.05143,78.85281,69.62176,71.20972,63.17184,64.08704,57.4052,65.26874,66.35984,63.35045,72.6064,83.21229,88.98,86.77791,79.93504,75.63292,87.35488,94.55418,97.64314,102.3455,107.8575,115.5708,121.7823,126.998,128.3358,128.5229,129.8812,127.4052,121.9527,113.3402,105.6707,101.6946,93.52236,82.76311,91.71301,101.8743,101.4947,91.49992,81.75829,73.30578,83.33291,93.54623,0,
0,108.9074,100.4903,94.96955,90.54661,87.3702,80.23905,72.4647,64.97029,56.71527,65.2547,73.70774,78.82356,73.29587,62.52454,62.2994,61.99498,56.56598,63.28231,70.0215,76.56228,74.66246,68.87401,79.46961,90.18238,94.1909,91.28728,83.88389,80.48302,84.59147,89.28112,94.58684,100.7402,107.8384,116.1755,124.7205,129.0469,130.1737,126.8282,121.9884,114.5208,108.2402,100.9343,94.09451,88.67038,79.62282,91.11036,99.77711,99.63865,89.73002,79.93088,71.33298,81.51579,91.80302,0,
0,108.7157,99.97388,91.22367,87.81208,82.66801,76.09772,65.56614,58.17159,56.05076,61.04712,66.47289,72.20823,67.92162,61.61242,55.48371,55.84031,59.19537,68.84972,77.58062,84.12962,83.31435,73.7246,78.21991,88.56014,98.00426,98.95236,93.41529,87.15426,89.09145,96.93015,102.568,109.4108,114.3232,118.3824,117.6385,122.9726,125.5543,118.8877,113.2748,107.9185,101.6752,96.47556,90.07398,83.32821,76.55347,85.72227,96.44599,97.61663,87.87654,78.04264,69.40973,79.64172,89.9986,0,
0,107.6182,97.96671,87.90103,78.44874,71.87684,66.40479,62.26378,66.31086,61.36776,55.40436,61.35076,64.84418,59.93835,54.95438,61.64664,62.70766,62.31184,67.77691,77.00326,87.86046,88.96848,80.00899,85.16432,89.58755,99.00705,105.6647,102.409,94.79028,96.16191,102.8801,110.5394,114.5004,114.5467,112.1607,108.4234,115.5655,119.7968,113.7378,105.4777,100.4348,95.80005,90.62031,86.29029,80.32652,73.89183,83.94926,94.41061,95.77786,86.06343,76.18815,67.5451,77.79317,88.20474,0,
0,108.7912,99.74575,90.6876,86.28751,79.51974,69.34292,73.12595,73.67932,67.80002,61.08501,54.50822,58.40012,54.35169,59.96154,67.79185,72.46268,71.71252,72.89141,82.10148,92.44745,95.07197,88.7528,91.46301,98.01992,103.5669,110.9695,109.4657,103.6518,104.6317,110.8031,114.7355,113.4566,108.5907,101.9429,100.3646,107.3915,115.0367,111.6879,100.9958,93.14607,89.44926,85.07787,80.65849,77.16255,71.34605,81.5903,92.25269,94.01879,84.3332,74.4047,65.74158,75.98237,86.43891,0,
0,110.1707,101.2108,92.20335,83.96807,77.81675,80.47523,79.9745,73.97012,67.94154,61.64628,54.73903,53.77756,59.19135,65.17667,72.0927,78.37318,81.42126,82.56132,88.03349,97.33057,101.726,98.73976,100.9319,106.2341,110.5717,114.7554,115.5126,113.8522,114.2141,115.7724,114.2103,108.8707,100.2607,93.36375,93.78916,102.4676,111.9565,111.3204,101.2152,92.27816,84.58247,79.40374,75.12287,71.38626,68.96404,79.28619,90.15087,92.42596,82.84445,72.90841,64.00189,74.21004,84.70142,0,
0,111.76,102.6883,94.57107,92.81223,88.66711,85.62403,78.04767,66.89785,59.16421,57.0266,58.6639,53.59101,58.28862,62.48351,66.09441,73.61855,80.33279,87.59661,95.42356,100.7155,105.1147,106.7777,108.8548,109.5619,108.3288,110.7536,114.1051,117.2144,116.0317,112.6332,108.6814,102.0342,94.49289,86.05354,95.92924,104.172,111.3397,113.2641,107.3673,100.8935,95.53934,90.58884,85.33984,77.56747,66.86073,77.16373,88.17102,90.93584,81.71606,73.60113,62.33668,72.46912,82.98412,0,
0,114.3794,107.8637,101.0459,95.03182,89.10881,82.62631,71.7735,63.35147,68.1067,66.37629,63.63211,58.06878,53.21497,55.23135,58.78015,64.43193,72.48911,83.44865,93.28072,94.13441,97.81922,101.7749,105.6141,103.7313,97.67732,100.4722,106.4984,113.0418,111.1567,104.1078,99.07344,98.53867,88.76804,81.33671,90.56335,98.46277,107.5692,111.8542,107.8889,103.5127,99.95995,94.24686,86.28191,75.35477,64.92157,75.17537,86.17129,88.46348,78.49084,68.06831,60.63163,70.72971,81.27493,0,
0,113.7704,105.1712,96.24795,87.84496,80.46856,73.96957,68.2818,74.26257,76.30613,72.51942,64.07409,57.10647,52.94756,57.45908,65.36452,72.37409,79.40482,86.65486,89.70508,84.79312,86.20235,92.11542,99.9254,97.30561,88.17912,93.37306,100.757,108.174,105.7867,97.33173,90.71453,94.96255,88.20999,77.22027,85.16911,92.77515,103.5124,107.3599,99.86012,94.22923,94.24612,87.43504,81.44564,74.37264,63.08185,73.27498,84.35303,87.19489,77.68068,67.55049,59.10257,69.10074,79.64483,0,
0,112.8553,103.8727,94.93818,86.8458,79.30084,74.65398,78.1014,81.63354,77.40757,70.47352,63.71864,57.71143,52.71407,57.52263,65.51459,72.45904,78.1731,83.58415,83.39667,75.68288,77.02367,86.17279,95.43039,91.82291,81.31005,87.71242,95.72335,103.438,100.7732,91.44617,83.59242,89.00672,82.69753,73.52781,80.10363,90.32182,101.0113,104.0018,94.3587,85.32845,86.06828,79.71957,73.89632,68.74773,61.25879,71.51302,82.44708,85.86389,78.38769,67.451,57.61,67.52065,78.08636,0,
0,112.6737,102.9481,94.35095,87.56853,88.11839,87.05177,87.43439,82.95423,72.66055,63.02006,56.79662,53.48246,52.44678,56.62019,60.22377,64.15214,69.50161,77.34966,76.51422,68.31679,76.68471,87.07519,91.87869,86.69531,75.79772,82.66142,90.67772,99.05896,96.07925,86.15161,77.3214,81.83137,75.72287,70.39375,79.05136,89.64543,100.1655,103.7035,94.9265,84.71885,76.00797,70.51425,65.99625,62.31221,59.57649,70.86196,79.40115,81.13189,73.48508,66.70125,56.13516,66.04593,76.73531,0,
0,115.8144,107.7312,101.3524,97.07226,96.94003,93.16461,87.62261,80.28469,71.88348,63.24858,55.54281,59.04668,57.0709,52.07975,56.17174,57.15942,64.20529,69.83582,66.89516,63.97261,73.97686,84.18984,85.32263,79.15586,71.21015,76.97202,86.10152,95.31301,91.40877,81.15366,71.84502,76.30053,66.25355,76.88243,85.49471,93.04378,99.85664,103.8731,100.202,93.20687,84.52243,77.63115,71.46049,63.78523,58.0517,64.97905,72.52248,75.34631,66.88935,60.09079,54.71658,65.17561,76.2181,0,
0,119.3801,114.3071,109.2004,103.1054,96.21597,88.90621,80.02119,72.98931,64.31337,58.28387,63.58424,65.82838,61.47796,56.04356,51.46957,57.0668,62.57925,61.3955,59.10356,67.07674,76.81435,80.65717,77.60439,70.34787,67.64713,76.75938,88.11804,93.03525,86.88544,75.65223,67.07578,72.61285,63.52665,74.8784,83.2154,86.93662,92.21426,99.43456,103.048,99.5406,91.48646,84.34657,75.77472,68.44189,62.65067,56.08125,64.56651,68.23275,61.89674,52.65102,61.7613,68.36819,78.30247,0,
0,118.5299,113.2187,107.5186,100.3587,89.82964,80.45939,72.29795,65.92619,61.56559,67.80352,71.36303,70.18938,62.00104,55.256,50.97889,54.3698,57.37227,55.36193,62.05305,71.10651,75.87595,73.5414,67.01978,63.43874,71.38647,82.60111,90.13674,89.49895,80.46935,73.55255,63.0356,69.22169,61.30408,69.17896,73.7265,78.2943,84.7972,91.46793,99.84953,103.6427,98.97605,89.58207,80.91101,74.37122,67.73844,61.27477,53.87049,61.16885,60.52481,51.22675,59.15179,68.82594,78.81808,0,
0,114.6442,106.0402,99.38696,93.83787,89.87835,83.92245,74.60332,66.13146,72.22507,75.84036,76.20173,71.30528,65.02808,59.2743,54.96657,50.21966,52.44628,59.29449,66.51834,71.22031,69.37403,64.11124,59.90546,67.03806,77.72958,85.46869,88.94559,84.88079,75.43057,66.1002,59.68605,64.52848,59.51913,62.41014,66.13176,70.88305,76.927,84.77666,94.57019,104.2662,103.4716,95.16456,88.36534,81.76035,74.96206,67.19032,59.16809,51.70021,56.88734,50.0051,58.66063,69.53578,78.26212,0,
0,111.6756,101.246,91.99021,85.58671,80.27186,75.56738,71.54254,77.34583,80.12319,79.08796,72.96162,64.79249,59.47287,56.60854,54.12266,49.62017,56.01176,62.17603,66.98466,65.47045,60.318,57.01369,64.16822,73.62029,80.45148,82.70522,82.51924,76.68056,70.64014,65.47341,57.40543,57.63433,66.46864,72.64864,77.21461,80.11636,85.28104,91.65781,100.5529,106.9073,107.157,102.866,97.26485,90.47456,83.14255,73.41437,65.4027,58.09721,49.63991,48.77065,55.54699,64.3838,75.18597,0,
0,113.6338,104.3331,98.16972,95.90131,89.55958,84.30981,83.73363,84.70105,81.07172,75.08876,66.64037,59.07857,54.13483,50.53092,48.55986,53.093,57.08742,61.54316,61.9444,57.44678,54.50306,60.42226,69.79633,76.63402,77.20203,72.7824,72.50247,71.33494,63.54794,59.3071,55.78859,62.45598,69.48502,75.67748,81.41637,87.54162,93.91416,99.66602,104.137,104.8868,103.6401,104.6922,101.4509,92.77728,87.02137,80.34808,73.22223,64.75322,56.72345,47.78197,55.03349,64.30243,74.47611,0,
0,116.7923,111.7354,107.2808,103.141,98.37355,93.96575,89.38634,83.24519,76.0744,66.8392,61.15001,57.84644,52.54668,55.69818,54.0107,47.33934,52.94189,56.76044,55.98917,52.13148,57.44976,66.00171,73.11338,75.28987,70.73444,63.33024,63.82597,64.35802,58.74019,54.65972,56.18996,58.59949,62.19567,67.14983,73.77366,82.64044,92.89159,101.4214,100.542,95.45483,92.67223,98.30604,98.87234,90.05287,80.37894,78.93253,74.1812,64.16018,54.62999,46.90498,54.21097,63.50992,73.63837,0,
0,116.3858,111.4844,106.6603,102.3044,97.89355,92.71792,85.81847,75.71137,68.16564,61.21414,55.14347,54.04219,58.86307,61.3179,57.18158,52.98188,45.82595,52.1916,49.03406,55.84516,62.0467,68.75154,72.83056,70.53074,63.08462,57.02107,57.7886,57.91573,53.60319,58.6879,62.89763,66.75723,71.05553,75.6635,80.16602,88.06771,97.42973,100.3453,94.39043,85.68008,83.13991,90.09859,93.32189,89.52052,78.99722,69.10437,69.76814,64.9129,54.91792,46.04669,53.36429,62.61402,72.71024,0,
0,111.7998,103.7986,97.7398,92.83786,88.56133,84.1918,78.31763,70.28921,61.73473,56.86694,61.54626,59.39172,65.55757,67.49684,62.69016,57.01027,52.42945,44.06724,51.53551,55.73597,60.99129,65.6154,65.37476,64.50228,58.14725,53.09665,55.0654,52.25481,57.99642,64.38011,70.69008,75.97021,80.64968,85.10923,90.14692,94.12315,100.9584,98.03794,87.05485,77.56613,75.35246,78.89328,85.87567,87.14962,78.21322,68.33836,59.87452,61.35798,55.26108,45.1518,52.5192,61.73175,71.76212,0,
0,107.2877,97.99584,89.60571,83.70869,78.86633,74.61085,71.44245,65.42715,59.12486,60.96807,68.82769,68.26996,72.44534,70.56114,62.34095,55.83452,50.82576,51.70389,42.13069,50.79209,54.68689,59.89427,58.46622,58.37138,53.78953,49.43396,50.73338,52.52147,58.37493,64.4774,69.64859,74.71082,79.85369,83.39916,91.94397,100.3526,103.8262,97.93938,87.0688,77.17388,68.77969,69.92221,77.63919,81.40718,79.61174,70.25162,60.64474,52.63293,52.68015,44.1879,51.77444,61.0493,70.76025,0,
0,103.7928,93.14496,83.83344,76.67021,71.05078,66.51151,63.90707,61.65321,68.05653,67.63591,76.20976,78.78466,77.90505,69.4477,61.33656,55.59959,56.4124,55.51942,50.08731,40.0119,49.8682,54.21436,53.1597,52.96419,47.07346,53.47657,56.79646,56.32558,54.96768,57.17705,60.50205,65.15604,71.38208,80.20383,90.47464,99.2345,99.72346,96.8512,87.40379,77.40083,69.14959,62.68755,66.37037,72.84759,75.8495,73.09129,63.55719,54.12887,46.79892,43.19522,51.88813,61.53073,68.77576,0,
0,103.9552,93.57956,84.53926,77.61295,72.20229,73.45028,73.99911,66.59222,75.65486,76.69787,83.74175,85.81226,77.21967,68.7566,62.39251,62.45757,63.6069,59.46354,54.43621,49.91875,37.73702,49.51996,50.42901,43.54861,52.45948,57.4886,63.3452,62.95358,60.84336,62.12905,68.35056,73.5612,79.47245,87.98311,94.05447,94.53338,90.11166,91.86185,90.51891,84.46687,74.96532,65.38703,57.79105,61.5472,68.02167,70.89714,67.99846,61.33408,51.64865,42.37262,50.23468,55.13975,63.91249,0,
0,107.2515,98.32201,90.24895,84.52315,79.35258,81.37239,81.74857,73.28244,80.89697,87.46495,90.55862,89.63329,83.14725,76.60398,71.9621,70.77274,69.55955,65.17182,60.39016,54.83965,49.54557,35.15163,38.8555,50.50903,57.31721,63.47504,69.39563,72.18509,69.82712,70.40829,77.66074,83.28893,88.41177,93.18058,93.18797,87.67175,79.65965,81.57384,86.3142,87.00629,80.93013,72.77831,63.58582,53.17035,57.13473,64.03474,66.34047,64.43874,57.583,50.34864,40.80796,49.58017,59.82549,0,
0,111.3857,103.7982,97.98936,93.09783,88.64133,90.13554,89.27787,81.90782,89.47189,93.39319,91.40035,86.62022,81.20422,75.86332,71.43424,68.8503,66.48681,63.78268,60.98185,55.9832,48.62512,33.50382,49.04911,54.49568,59.78757,65.29464,71.7635,78.27639,79.75924,80.60432,83.74332,85.87612,89.74213,93.27209,89.12537,79.11101,71.03648,71.43909,78.05736,82.0154,81.91819,72.98161,63.06701,55.07347,48.88429,55.36455,57.2436,61.13535,58.28266,50.33487,39.61368,49.0253,58.7492,0,
0,115.0929,110.4709,105.8669,101.934,98.88516,98.77354,96.88181,92.47175,95.50341,92.51155,85.9633,77.40378,71.46347,66.54656,61.79631,59.79224,57.96864,56.31087,55.3661,52.10257,48.64223,32.00557,48.56271,53.56802,54.63383,59.38805,66.66988,76.80824,81.0461,79.39442,79.40253,76.04303,81.12477,88.19416,85.02576,73.52995,64.21073,63.40038,66.65452,74.231,78.67375,76.82959,70.71545,63.71807,55.36224,44.79819,47.97382,54.35917,52.57812,45.81069,38.56974,48.07525,58.58242,0,
0,112.5183,107.6834,103.3187,100.5142,98.83679,98.02862,100.1569,100.5261,97.25118,87.65437,77.62836,69.38986,63.04911,58.52459,55.58495,53.60278,52.11518,50.22143,47.4913,43.60957,46.82073,30.47438,41.1063,48.12964,53.36612,58.73049,66.71771,75.33082,74.8465,68.55257,68.9506,66.6663,74.17274,83.72828,84.07308,74.37058,64.90357,56.79288,57.84077,65.01328,71.38447,74.55753,73.43013,66.77499,57.57053,51.00543,40.48945,46.6973,45.67259,36.97097,47.1607,54.60841,62.33703,0,
0,107.4501,99.09697,92.98515,90.49627,89.18835,87.71709,94.18108,98.50876,96.14035,85.50423,75.90853,68.24315,62.62103,58.73359,56.26432,57.88996,57.73658,56.83006,53.06971,49.95059,36.01587,29.08585,47.25867,53.72197,58.54091,64.0214,69.8801,71.8592,67.72024,59.63974,60.04097,59.90987,68.84403,80.21695,82.48649,75.16227,67.36329,60.02409,51.02993,60.18607,60.64848,67.27019,68.31567,61.42164,57.68119,53.48933,46.20636,36.12574,35.14378,43.08567,47.28017,55.75546,65.70518,0,
0,103.4859,93.41033,84.74429,80.87009,79.85791,78.4291,85.3369,93.73531,97.0479,91.60902,82.75575,75.81877,69.12959,63.53388,62.81728,65.25806,66.05148,62.17447,58.05754,51.84426,46.64978,27.95451,44.30505,50.27335,56.97123,62.5256,66.78277,64.92545,58.77641,53.15123,53.23014,60.2393,69.56097,79.83781,79.84966,68.86624,60.06089,53.18979,47.47092,53.00084,51.89076,60.00498,62.26079,54.4275,48.24809,48.13208,42.90182,33.49644,43.12121,49.34206,55.61406,61.58815,70.2776,0,
0,102.1122,92.49202,83.1144,74.85492,71.77641,70.83637,78.75756,87.74245,93.29114,95.13847,90.76963,83.02537,77.08327,72.07204,72.08657,74.40562,72.91179,67.74917,60.67669,53.93603,48.3743,42.75969,25.93268,43.32225,50.5831,55.34724,59.10253,57.51741,50.92724,48.58354,53.80477,60.85587,70.21075,80.32358,81.63773,75.03016,68.23019,61.9066,53.83175,43.06929,44.57961,53.18999,55.70284,49.3274,40.20893,41.09132,31.91019,42.99373,50.17388,57.29007,63.61986,69.73712,75.67986,0,
0,101.5699,92.08247,82.68266,74.41434,67.10808,64.74023,72.45083,78.42502,86.94711,93.04291,94.86987,90.69065,86.33523,83.16588,81.47258,76.40422,70.11364,64.02557,56.95214,49.04977,40.84533,33.58321,24.49718,37.78635,43.1221,50.31754,50.52437,49.89972,44.86871,49.31959,54.53317,61.60594,71.15961,80.07841,79.19613,74.06241,69.12289,64.64748,56.1374,49.38577,38.15437,44.97909,46.76175,45.33165,39.67675,30.30144,33.92722,44.79022,52.13999,57.72102,63.84903,69.47151,78.25456,0,
0,101.5683,92.68172,83.59076,75.248,67.51663,60.92811,63.67856,70.71156,78.46216,88.33029,92.20533,88.69973,85.19852,86.26959,82.36532,71.48845,62.21637,55.83725,51.32384,47.55563,49.39508,45.68376,40.22085,22.8292,40.92234,41.9766,42.77163,40.45446,48.09682,56.50832,62.61594,68.86333,75.25611,76.96346,72.36903,65.21341,59.59492,58.59806,57.58285,53.03772,45.15387,33.38415,39.77954,38.49742,28.86699,38.43134,44.12985,39.69834,43.61009,49.56421,56.49933,66.32127,76.59827,0,
0,99.939,93.66369,87.1575,80.79135,74.52471,66.94727,56.88367,63.51458,72.82759,83.76656,86.22121,79.2766,73.87318,80.99199,83.81514,77.61767,68.57178,62.36311,56.47016,56.08498,54.20322,47.26898,37.77276,21.62636,36.64492,28.65557,34.20508,46.37432,53.30579,59.84004,64.70678,69.60056,74.35374,71.85929,62.73676,56.87744,51.87574,47.54858,49.3049,52.40568,48.26912,39.97236,28.45637,27.2845,37.26931,44.01099,51.55614,49.60872,50.36711,49.49521,55.81872,65.80611,76.40908,0,
0,95.55659,86.60788,79.49937,73.84438,70.6481,65.08746,54.4517,63.4795,73.7002,80.97878,80.6655,72.07645,64.79697,74.58609,81.22409,81.46808,76.33872,70.91726,64.46586,61.63838,54.28513,47.35014,39.72537,36.92255,20.11686,35.35167,41.36812,48.63422,52.54776,56.4284,56.16463,61.68886,69.56313,67.32837,56.67106,47.72638,47.51136,40.10316,39.88228,46.80984,46.6315,38.39201,25.82077,36.88291,44.03763,51.19563,57.11933,59.24706,58.73686,55.64931,60.84314,68.26125,78.74393,0,
0,92.0035,81.36403,72.30588,65.51127,60.13792,60.84168,52.19537,61.89648,67.90028,74.48102,74.96867,66.16897,57.99205,66.76936,76.53322,79.58302,76.73225,75.88249,70.11454,60.25431,52.28173,46.34572,40.78548,33.82756,35.14338,18.38012,37.55515,45.20092,43.92996,49.05405,48.42325,56.2776,65.82719,64.88558,56.85265,48.41686,37.91196,38.45169,31.133,40.70164,40.46126,33.39461,24.98245,36.68066,43.83115,49.48022,55.9735,62.50585,67.26344,65.4389,67.12084,74.52683,83.1916,0,
0,92.08582,81.52295,72.23888,64.62809,58.38982,53.33398,50.0255,54.8777,62.13444,64.64001,68.47739,61.24186,52.72258,61.55208,71.34962,72.25602,66.59752,71.92265,72.64799,66.50228,58.24197,52.7168,47.75127,44.48045,35.68783,17.30314,31.35104,37.5805,34.2226,40.26221,47.69389,56.3616,64.63339,61.33372,50.72731,41.6058,38.5108,28.62299,25.36609,33.13445,33.36153,23.79252,33.81681,29.84358,33.35915,40.63322,48.70452,58.56674,68.86835,74.7045,77.84854,81.21049,88.6957,0,
0,95.51599,88.662,81.13677,72.59408,66.75244,61.85875,55.81109,47.59438,54.30268,55.35729,62.25846,58.37819,48.44693,57.1848,66.36491,65.02391,57.16596,65.38279,70.63076,70.03996,65.39281,60.29816,52.33818,44.01212,34.78914,32.41477,15.83531,24.09663,37.34505,46.65409,53.34604,60.04028,63.32986,58.79619,50.8961,40.53427,30.11866,29.40399,20.53126,21.40268,22.37077,32.42056,39.33268,41.79855,43.92274,38.96446,48.1159,58.36111,67.2049,74.74189,80.83479,87.07582,93.10049,0,
0,97.33621,92.19645,86.08237,80.74165,75.58371,69.82618,62.54335,53.19776,44.65193,49.78526,55.51022,54.12494,44.69281,53.2089,61.63062,58.78683,49.81512,57.14005,65.11147,66.02345,64.97937,63.55482,57.72091,50.45761,43.02737,31.60081,14.98726,29.56707,36.54267,44.30117,51.78836,58.4353,58.45749,51.02314,44.8761,40.12168,30.04795,19.30525,29.98237,33.71216,34.14293,26.85631,38.59747,46.35714,51.20127,49.70554,44.53312,51.95534,60.57079,67.08843,73.48261,83.03593,90.58501,0,
0,93.26633,84.71731,79.61485,78.99086,74.6673,70.08597,65.60314,58.39447,51.15716,41.61958,48.40211,49.72028,41.21229,49.607,56.26621,53.17044,43.74951,51.39889,58.1456,56.12066,55.63963,59.71331,58.77964,50.7574,41.62444,31.88339,29.30959,13.68426,25.79058,36.36541,45.93774,53.88371,52.92815,44.42334,36.9968,31.21937,28.26971,18.26054,29.77928,40.06734,42.59687,39.24017,31.6263,43.57457,51.71413,56.23302,53.39383,50.19966,54.24067,59.1822,66.65368,76.20925,87.24524,0,
0,89.51352,78.93168,69.82579,70.63525,65.03176,60.19109,59.19814,55.69643,51.80096,46.59344,38.4691,44.07233,37.59769,46.94845,48.17312,47.37808,38.291,47.62614,49.35629,46.94242,45.87623,53.13346,55.71535,53.62594,48.20513,40.88492,27.86379,12.84469,26.94723,33.95541,40.4088,49.16582,46.98262,38.33793,29.889,23.97139,16.89772,20.75366,31.08337,41.58834,47.81195,47.75133,43.81469,36.44146,48.18338,56.42168,61.59829,61.58658,62.4614,68.92586,69.09512,77.89079,88.43589,0,
0,88.69773,78.46928,68.60043,60.06118,55.46288,51.94876,48.92334,46.09003,43.40096,40.6784,37.88177,35.39492,33.94291,41.78412,39.71297,40.34607,32.99421,42.54663,41.29826,38.98812,37.52616,45.89632,46.93187,48.58186,49.60014,44.61944,35.61832,26.76662,11.6514,23.66384,35.92312,44.4286,40.5892,31.09694,23.67211,15.38535,25.90954,31.83004,26.96674,35.53218,45.17966,53.22617,51.99795,45.49336,41.23302,52.6546,61.00885,67.79948,71.97337,76.59139,79.87756,83.72152,92.25169,0,
0,89.28326,78.5656,69.34104,70.52463,64.30614,62.8917,57.78215,54.09199,51.72556,46.88727,38.85401,44.23706,41.1278,32.01812,30.53333,29.27004,27.99194,36.60356,33.26356,31.32989,29.83275,38.89807,37.58918,37.67514,43.77592,44.10577,35.25933,23.80714,10.79758,25.17026,36.8915,38.66521,31.02075,23.9066,13.88868,19.5613,31.45297,39.10192,37.0686,33.55296,43.46758,53.50658,58.24243,56.06993,49.90276,45.92341,55.239,64.34148,70.21519,76.09777,82.41483,89.51822,96.24826,0,
0,93.23133,84.48371,78.58773,79.47324,75.3841,71.75256,66.50374,59.40219,51.94194,42.47086,48.38771,47.50578,37.51681,42.79473,40.98107,40.33801,36.15931,26.28398,24.93446,23.7913,22.68023,31.90627,28.49436,27.57415,36.48822,38.50248,35.11965,23.93014,10.19399,25.81926,34.67526,31.25263,22.83989,12.38397,25.12338,30.9691,28.47299,40.06584,45.89969,43.42361,40.5255,50.2317,59.7928,63.30987,60.63108,54.26562,50.1964,55.2411,60.96212,67.64982,75.73451,85.74588,95.45438,0,
0,98.24299,93.25235,88.71371,85.80839,79.43652,72.52219,64.69934,56.28696,46.01279,52.59351,55.45591,51.06216,41.12564,49.856,49.90624,43.49916,31.84791,37.7742,35.98446,35.54877,31.53745,20.88957,19.41009,18.14997,28.55543,27.34487,27.5689,23.10719,9.666203,20.48267,27.54414,23.2446,10.8807,19.98142,26.78468,37.60276,38.53012,37.59788,48.2334,52.53477,48.92557,47.97971,57.45235,66.61866,68.65305,64.63619,56.12166,55.24796,61.20684,67.94167,75.95136,85.45859,95.20715,0,
0,99.6357,94.09857,88.36034,82.52118,73.68771,65.90147,58.1291,49.46714,54.7333,60.28313,60.58247,52.50917,44.89969,54.24265,54.03164,44.5387,35.6746,45.1921,45.7414,39.00899,28.98323,31.62465,30.74378,28.48343,15.98256,14.40684,12.95104,11.61133,20.69669,8.996545,19.43767,9.517629,20.91299,26.47352,33.44457,41.45259,48.26185,46.34661,47.88882,57.55192,57.73356,56.12183,56.76052,65.50975,74.44789,71.75862,63.31039,62.93888,61.84592,67.36103,75.85508,85.58961,95.51641,0,
0,95.87097,86.94962,79.89645,73.89648,67.95655,60.31603,52.8923,58.38829,64.39397,66.40924,60.50232,50.42155,53.03658,59.56268,58.43747,50.25951,39.56757,49.52859,51.71429,43.51218,35.06693,42.06261,41.09433,32.61657,22.16099,26.24043,24.57953,25.096,27.66056,20.75634,8.170566,20.59716,28.75995,36.57524,41.0801,47.61512,55.32239,55.5535,56.51947,61.94595,67.18934,65.43889,65.45413,71.14515,79.27621,78.62436,72.29079,72.32203,71.86988,74.08945,78.24879,86.99084,96.90828,0,
0,92.85545,81.61578,72.61345,65.83951,60.4196,56.02385,61.52538,68.44072,72.08604,66.56687,57.12743,56.1563,63.36438,66.37666,61.66833,51.98967,43.36629,53.24725,56.68708,49.33348,41.95102,48.96561,46.88047,39.11277,28.65232,37.22097,35.71784,36.29295,31.62707,19.98345,7.71673,17.37211,27.36994,37.50504,47.47525,54.60154,60.66157,64.4127,66.74945,70.29392,73.43861,73.95604,75.09031,78.89577,83.13015,84.39731,82.40674,82.10574,81.92129,83.98798,87.92096,93.22163,99.4728,0,
0,95.86967,88.37181,80.87526,74.28618,67.82346,58.96907,67.88124,76.37258,79.08799,72.17491,62.50079,63.14198,70.81407,70.81493,60.89498,52.29395,47.51586,55.84634,62.32874,57.88051,49.84489,54.86082,48.53368,39.01495,37.79288,44.64698,45.0522,39.9026,29.34679,17.97388,7.442454,16.86842,27.10222,37.26918,46.86145,52.86414,58.09382,63.26003,68.24397,69.93966,68.07221,68.28065,71.7715,75.88445,76.697,80.08002,81.8103,81.39232,79.9026,81.77116,86.08596,91.5371,96.87786,0,
0,98.34835,89.15459,79.84186,71.41324,63.72563,65.309,73.07125,82.29844,83.04795,73.03638,70.9719,72.00337,77.83157,75.7379,65.99359,58.2492,52.75423,60.55889,68.49798,65.60257,58.89215,61.24347,53.65069,48.02992,47.78722,50.84645,47.38412,37.74335,27.15694,16.60712,7.234757,18.65501,29.79217,36.59356,38.61645,43.1418,48.72136,54.77694,63.23746,62.82867,56.36169,56.15869,61.5873,67.48621,64.68687,71.26142,72.4574,71.61387,68.58522,70.65578,76.68649,83.10227,91.36568,0,
0,100.0012,90.70109,81.55619,73.61852,67.65537,73.22825,79.54896,87.91077,88.46111,81.84157,80.77183,82.8054,84.52383,80.78778,71.87725,63.85601,60.86296,66.7886,74.05401,72.80562,68.80857,66.58815,61.76338,58.12379,56.60904,52.18127,45.19626,37.63366,29.9199,18.71661,7.096141,17.66804,21.90947,28.31674,28.34186,34.78179,39.8927,49.07022,58.37124,55.7298,47.07251,46.89828,55.54473,57.61654,54.89163,62.95747,63.50841,65.55873,57.71662,62.75728,68.6936,77.12038,86.28107,0,
0,101.5907,92.27654,83.18546,75.1724,74.4411,80.85477,86.9171,94.06941,95.24023,91.78221,89.56583,86.9224,84.09682,83.63508,78.93623,73.50603,71.28762,75.60394,78.17136,74.26022,68.67088,63.84894,59.61174,58.20847,56.80049,47.93808,37.74487,29.04302,21.56439,20.93442,15.33081,6.777775,10.89116,16.25154,22.10221,29.04769,40.11475,50.3917,54.10544,49.15678,39.58057,39.94865,49.01058,49.04372,47.08719,55.71693,55.36771,59.40274,50.97593,56.29324,63.32274,72.17424,81.6881,0,
0,103.4701,93.94973,85.56839,84.5504,83.39068,88.18331,95.18482,99.05711,97.3375,91.94579,86.35464,80.49909,73.58437,76.58244,79.48682,81.61665,80.39074,78.30486,74.10226,68.53916,60.27542,53.80696,48.4609,48.35741,52.19784,48.85682,39.28719,29.37241,20.11083,11.36994,6.384694,16.89362,23.5458,28.77787,33.7656,38.88663,44.62457,48.74405,46.58001,41.14458,33.1122,34.03008,42.88846,41.50503,40.55458,49.1821,47.85455,53.45369,45.85058,51.58428,58.49308,67.52241,77.50211,0,
0,107.1533,100.9376,96.13673,94.20005,93.13513,95.44682,98.89167,97.9918,92.93712,84.45457,77.62866,70.72556,63.83007,64.81987,72.32725,77.97757,78.42133,72.99065,64.81882,58.96948,53.23787,46.12433,39.36912,38.12172,45.03077,45.11484,41.73547,32.2425,22.3619,13.29235,6.182178,16.55527,27.59077,33.43215,37.75623,40.44224,42.23789,41.74988,35.57317,36.37255,27.55783,28.84486,36.06947,34.53983,34.86317,42.14038,40.74593,46.61348,41.66778,46.79471,53.64046,63.05207,74.18278,0,
0,109.3392,103.7337,98.22939,93.5669,89.95348,88.6987,91.89027,91.799,84.75522,78.40826,70.51929,63.87988,56.2019,55.25022,62.89701,72.24121,73.00475,64.47713,57.31701,50.34248,45.40356,40.64671,34.54017,29.86613,37.0966,35.22427,38.34785,34.26189,24.34926,14.17152,6.081667,17.23711,25.54694,24.74233,31.10296,31.13457,32.32398,33.59409,26.30993,29.62262,22.76891,24.40386,26.29791,28.07256,29.94183,32.1621,34.5393,37.24452,41.38736,48.24568,55.97317,65.2309,75.19391,0,
0,105.002,96.80629,90.08317,84.44981,78.72904,76.08804,83.03341,84.88821,77.41545,71.35474,66.08057,58.52394,52.52167,47.45987,57.0599,67.36342,68.0736,58.51785,49.90215,43.76559,38.26298,34.21227,30.34941,24.75023,27.45191,25.01157,31.26115,30.34735,25.33049,15.17328,5.988284,12.89353,17.19734,15.44435,23.36635,21.4989,22.82996,25.78681,18.59145,20.41133,28.06607,34.80073,35.93591,36.45332,38.03321,38.86513,45.48748,47.10924,48.6613,48.94445,55.85485,65.08921,75.92194,0,
0,99.93528,90.81614,82.23288,76.08009,70.81852,66.00515,75.66223,78.51714,70.6795,63.60968,64.71157,54.84438,48.00809,42.50286,52.53276,63.11584,64.38683,53.43425,44.41326,37.60629,32.36,28.1463,24.76242,21.87415,19.14359,16.6665,23.0609,20.47692,19.42761,16.07658,12.04743,5.807981,6.4768,7.568502,17.1392,12.35619,14.12435,16.01721,23.67607,28.35905,34.44267,41.41492,46.67614,46.37959,47.56754,47.89373,52.90786,58.02018,58.19685,58.16133,63.67373,70.76048,79.84908,0,
0,95.42281,86.00755,76.88403,69.53405,64.05993,59.10272,69.80215,72.89408,64.62006,56.86909,62.94551,56.09344,44.47918,38.59481,47.89593,59.7415,65.43983,60.34832,54.13163,46.61617,41.73011,37.53885,33.27034,32.7384,27.97244,22.06125,12.90341,10.28909,8.167145,6.534925,5.713624,13.19993,16.96909,17.8972,9.976919,19.39304,24.95521,23.10476,29.92009,36.67738,42.32643,49.94221,54.93031,56.68907,57.95917,58.79525,62.14554,66.13084,67.86588,69.24842,73.56667,79.03736,84.61934,0,
0,91.29028,81.89267,72.54537,64.99614,58.72351,53.68864,64.8887,67.89079,59.2089,50.74631,58.99284,55.50409,44.82968,35.34777,47.14512,57.24251,62.56743,62.00225,59.72054,55.41879,50.98283,46.82177,43.3899,41.35656,36.49916,27.879,22.07052,21.70457,18.36362,13.12069,5.713624,12.98803,22.02329,24.93394,20.36881,25.73158,33.31224,32.08645,37.35964,45.28265,50.61459,54.51198,55.60423,58.75343,60.08507,59.83812,61.05109,64.78353,66.70267,70.328,75.05264,80.43981,85.66974,0,
0,87.20818,77.8811,69.07522,61.12919,54.71455,49.28889,60.45935,63.27807,54.31845,45.33559,54.68609,52.86359,42.22146,32.31222,41.50567,52.32074,53.40738,52.92783,55.41272,53.56614,48.42819,44.06363,42.50125,41.86015,40.31033,35.81862,31.93581,28.77702,20.11384,11.55906,5.713624,11.61394,20.70165,29.61278,31.38532,35.16938,39.5437,41.80365,45.4393,49.61162,50.52071,48.17886,45.22189,51.32539,50.95041,49.58962,50.00859,56.46401,55.92178,60.87741,66.45541,72.74714,81.05215,0,
0,83.06882,73.65286,64.81645,57.77405,51.12458,45.50372,56.4599,58.73808,49.76506,40.46021,50.40586,49.75429,39.53517,29.65687,41.01236,48.50604,44.31098,43.01728,45.46462,46.96937,38.87325,32.89363,32.26992,32.49556,34.43624,33.45197,31.88638,28.84999,20.00541,11.22266,5.713624,11.26137,20.22223,29.46524,33.23506,35.41623,37.60189,39.56981,41.71775,43.68857,43.1642,36.68904,35.61191,43.08534,41.58617,39.41333,40.58442,47.54271,46.66708,52.59817,58.3435,66.6125,76.31399,0,
0,79.03473,69.22131,60.32577,53.42713,47.92693,42.11135,52.34446,53.39149,45.24843,36.02527,45.69087,45.69331,37.98616,27.13612,37.61845,42.37581,35.91011,34.35133,36.14234,39.70195,33.23429,24.33579,23.16093,23.39379,24.36987,23.70492,22.94671,23.63004,20.20755,11.78578,5.713624,11.85706,20.56093,24.79615,24.70725,26.04761,27.6699,29.34938,31.12057,33.02453,34.93566,27.79086,28.26542,34.68562,33.5392,30.64461,33.24851,36.68449,40.83302,45.84494,52.28043,61.36636,73.10371,0,
0,75.76968,64.76487,55.50921,48.66216,43.35538,39.06,45.95446,44.90784,39.7245,32.0868,37.92904,37.02933,32.22314,24.74847,31.72153,35.35125,29.20932,27.17916,28.15057,30.60573,30.84148,24.41219,15.62419,15.9776,15.79924,14.85608,13.96237,14.17541,14.27754,11.23317,5.713624,11.40895,15.01798,15.49751,15.83097,17.27331,18.87374,20.49622,22.14424,23.96916,27.13178,21.17903,22.86822,24.75107,27.0746,37.11427,42.96583,40.23629,49.67257,54.22982,60.08108,67.19656,76.54272,0,
0,76.74668,66.10569,57.17109,50.44726,44.89942,40.00199,35.64536,33.27946,31.15289,29.11404,27.50671,25.96425,24.4617,23.07223,21.93049,28.58857,27.07968,21.40988,21.77856,22.3966,23.50412,18.80538,10.50227,9.220002,8.20999,7.353783,6.672859,6.164836,5.786175,5.713624,5.713624,5.713624,6.164478,7.019128,8.124022,9.54872,11.21433,13.0173,14.85513,16.66381,18.62644,26.50708,32.51868,31.60047,37.78419,37.48055,48.14711,49.71056,48.88034,59.76839,68.1431,75.09726,81.6829,0,
0,80.61063,71.73791,64.78674,59.06428,53.98262,48.6897,47.59418,42.60102,42.73686,38.01455,36.97886,35.33052,33.74519,33.22223,27.88777,20.18789,18.86935,17.6397,16.485,15.24333,13.92797,12.58237,19.70444,18.39988,17.32781,16.23456,15.14371,14.10395,13.79499,10.57644,5.713624,10.54155,14.33686,16.98358,17.21762,18.66826,20.26403,21.88227,23.50981,25.13348,26.51861,32.3917,40.51358,40.65788,47.05878,46.77187,52.76656,59.75964,58.8149,58.87877,66.52779,75.43094,85.14104,0,
0,85.05934,79.44358,73.70387,68.48658,63.55754,59.3623,56.96441,53.46059,52.08374,48.79713,47.26073,45.55304,43.70439,41.09034,34.88998,29.79406,27.77711,26.43015,25.30701,24.2272,23.23101,22.81376,25.98837,27.06057,26.38271,25.35409,24.16366,22.4876,18.13648,9.811693,3.873222,8.487304,15.85058,23.65745,26.15308,27.81059,29.4368,31.10734,32.83831,34.6469,36.69393,41.20392,46.97285,50.85738,55.03114,57.41694,61.7614,66.75268,68.69421,69.90594,74.79813,81.83289,88.6298,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,])

# flip and mirror the esri ascii file to convert to landlab format
z1 = np.reshape(z,(85,55))
z2 = np.flipud(z1)
z3 = np.hstack(z2)

# construct the model grid
mg = RasterModelGrid((85, 55), xy_spacing=(5.0, 5.0), xy_of_lower_left=(0.0, 0.0))
mg.add_field('node', 'topographic__elevation',z3,clobber = True)
mg.set_closed_boundaries_at_grid_edges(True, True, True, True) #close all boundaries
node_id = np.arange(z3.shape[0])
mg.add_field('node', 'node_id',node_id,clobber = True)
#view existing landscape
depth =  np.ones(z3.shape)*1
mg.add_field('node', 'soil__thickness',depth)
mg.status_at_node[np.isclose(z3, -9999.)] = mg.BC_NODE_IS_CLOSED
# mg.set_watershed_boundary_condition(z) #finds lowest point in dem and sets it as an open node
mg.set_watershed_boundary_condition_outlet_id(31,'topographic__elevation')
slope, aspect = mg.calculate_slope_aspect_at_nodes_burrough(vals='topographic__elevation',)
sfb = SinkFillerBarnes(mg,'topographic__elevation', method='D8',fill_flat = False, ignore_overfill = False)
sfb.run_one_step()
fr = FlowAccumulator(mg,'topographic__elevation',flow_director='D8')
fr.run_one_step()
# imported DEM
_ = mg.add_field('topographic__initial_elevation',
                    mg.at_node['topographic__elevation'],
                    at='node',
                    copy = True)


mg.delete_field(loc = 'node', name = 'flow__sink_flag')
mg.delete_field(loc = 'node', name = 'flow__link_to_receiver_node')
mg.delete_field(loc = 'node', name = 'flow__receiver_node')
mg.delete_field(loc = 'node', name = 'topographic__steepest_slope')

# run flow director, add slope and receiving node fields
fd = FlowDirectorMFD(mg, diagonals=True,
                      partition_method = 'slope')
fd.run_one_step()

# hillshade for plots
mg.at_node['hillshade'] = mg.calc_hillshade_at_node(elevs=z3, alt=30., az=210.)

np.random.seed(seed=7)
nn = mg.number_of_nodes
mg.at_node['particle__diameter'] = np.random.uniform(0.05,0.25,nn)
mg.at_node['mass__wasting_id'] = (np.ones(nn)*0).astype(int)
mg.at_node['soil__thickness'] = np.random.uniform(0.35,0.75,nn)

# mass wasting areas
ls1 = np.array([570,516,571])
mg.at_node['mass__wasting_id'] = (np.ones(z3.size)*0).astype(int)
mg.at_node['mass__wasting_id'][ls1] = int(1)


# mg.at_node['mass__wasting_id'][ls2] = 2


# # confirm that topo matches nmg for later mass wasting router tests
# # nmg from nmg tests
# y_of_node = (0, 100, 200, 200, 300, 400, 400, 125)
# x_of_node = np.array([0, 0, 100, -50, -100, 50, -150, -100])+150
# nodes_at_link = ((1, 0), (2, 1), (1, 7), (3, 1), (3, 4), (4, 5), (4, 6))
# nmg = NetworkModelGrid((y_of_node, x_of_node), nodes_at_link)

# #view existing landscape
# plt.figure('topo')
# imshow_grid(mg,'topographic__elevation',grid_units=('m','m'),var_name='Elevation(m)')
# graph.plot_links(nmg,color = 'black', with_id=False, linewidth=1)
# graph.plot_nodes(nmg,color = 'red', with_id=False,markersize=3)




#######
# use this to get values for manual computations
###
def plot_values(mg,field,xmin,xmax,ymin,ymax):
    """plot the field values on the node within the specified domain extent"""
    values = mg.at_node[field]
    if values.dtype != int:
        values = values.round(decimals = 4)
    values_test_domain = values[(mg.node_x>=xmin) & (mg.node_x<=xmax) & (mg.node_y>=ymin) & (mg.node_y<=ymax)]
    ntd = mg.at_node['node_id'][(mg.node_x>=xmin) & (mg.node_x<=xmax) & (mg.node_y>=ymin) & (mg.node_y<=ymax)]
    for i,val in enumerate(values_test_domain):
        plt.text(mg.node_x[ntd[i]],mg.node_y[ntd[i]],str(val),color = 'red', fontsize = 7)
    


xmin = 80; xmax = 165; ymin = 0; ymax = 80
field = 'node_id'

plt.figure(field,figsize = (12,8))
imshow_grid(mg,'topographic__elevation',grid_units=('m','m'),var_name='Elevation(m)',plot_name = field,cmap = 'terrain')
plt.plot(mg.node_x[31],mg.node_y[31],'r.')
plot_values(mg,field,xmin,xmax,ymin,ymax)
plt.xlim([xmin,xmax]); plt.ylim([ymin,ymax])
z_d = z3[(mg.node_x>=xmin) & (mg.node_x<=xmax) & (mg.node_y>=ymin) & (mg.node_y<=ymax)]
plt.clim(z_d.min(),z_d.max()*1.5)

###
###






#%% Mass wasting runout, full run

# view test topography and landslide locations
LLT.plot_node_field_with_shaded_dem(mg,field = 'mass__wasting_id',fontsize = 10)
LLT.plot_node_field_with_shaded_dem(mg,field = 'soil__thickness',fontsize = 10)

            

# mg.at_node['topographic__elevation'][523] = mg.at_node['topographic__elevation'][523]+3
# fd = FlowDirectorMFD(mg, diagonals=True,
#                       partition_method = 'slope')
# fd.run_one_step()



LLT.plot_node_field_with_shaded_dem(mg,field = 'topographic__elevation',fontsize = 10)
plt.xlim([xmin*.8,xmax*1.2]); plt.ylim([ymin*.3,ymax])
plt.clim(20,60)

npu = [1] 
nid = [1] 
slpc = [0.10]   
SD = 0.1
cs = 0.0125

mw_dict = {'critical slope':slpc, 'minimum flux':SD,
            'scour coefficient':cs}

release_dict = {'number of pulses':npu, 'iteration delay':nid }

# example_MWRu = MassWastingRunout(mg,release_dict,mw_dict, save_mw_dem = True,
#                                  opt1 = False, opt2 = True, opt3 = True, opt4 = True)


example_MWRu = MassWastingRunout(mg,release_dict,mw_dict, save = True,
                                 routing_surface = "energy__elevation", settle_deposit = True)

example_MWRu.itL = 12

example_MWRu.run_one_step(dt = 0)




#%%
# get values for tests
xmin = 80; xmax = 165; ymin = 0; ymax = 80
field = 'particle__diameter'

plt.figure(field,figsize = (12,8))
imshow_grid(mg,'topographic__elevation',grid_units=('m','m'),var_name='Elevation(m)',plot_name = field,cmap = 'terrain')
plt.plot(mg.node_x[31],mg.node_y[31],'r.')
plot_values(mg,field,xmin,xmax,ymin,ymax)
plt.xlim([xmin,xmax]); plt.ylim([ymin,ymax])
z_d = z3[(mg.node_x>=xmin) & (mg.node_x<=xmax) & (mg.node_y>=ymin) & (mg.node_y<=ymax)]
plt.clim(z_d.min(),z_d.max()*1.5)


#%%
Visualize = True
if Visualize:
    # plot how DEM changes
    for i in np.arange(0,len(example_MWRu.mw_ids)):
    
        for c in example_MWRu.df_evo_maps[i].keys():                  
            plt.figure('dif'+str(c)+str(i),figsize=(12, 12))
            mg.at_node['df_topo'] = example_MWRu.df_evo_maps[i][c]-mg.at_node['topographic__initial_elevation']
            # imshow_grid_at_node(mg,'df_topo',cmap ='RdBu_r')  
            LLT.plot_node_field_with_shaded_dem(mg,field = 'df_topo', fontsize = 10,cmap = 'RdBu_r', plot_name = 'dem dif{},{}'.format(i,c) )

            plt.xticks(fontsize= 8 )
            plt.yticks(fontsize= 8 )
            plt.clim(-.01,.01)
            plt.xlim([xmin*.8,xmax*1.2]); plt.ylim([ymin*.3,ymax])

# scour_entrain_deposit






